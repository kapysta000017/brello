name: Checking CI

on:
  pull_request: # ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ pull request
  push: # ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ½Ğ° push Ğ² Ğ²ĞµÑ‚ĞºÑƒ main
    branches: -main

jobs: # Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹
  code: # ĞºĞ»ÑÑ‡ Ğ´Ğ¶Ğ¾Ğ±Ñ‹, Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ»ÑŒĞ½Ñ‹Ğ¹
    name: ğŸ˜ Checking code # Ğ¸Ğ¼Ñ Ğ´Ğ¶Ğ¾Ğ±Ñ‹
    runs-on: ubuntu-latest

    steps: # actions
      - name: ğŸ‘ Checkout
        uses: actions/checkout@v3 # ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°ĞµÑ‚ Ñ€ĞµĞ¿Ñƒ

      - name: ğŸ’‹ Use Node.js v18
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: ğŸŒ¹ Enable corepack
        run: corepack enable # Ğ±ĞµÑ€ĞµÑ‚ Ğ²ĞµÑ€ÑĞ¸Ñ packageManager Ğ¸Ğ· package.json, corepack ÑƒÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ Ñ node; enable - corepack ÑĞºÑĞ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ñ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹

      - name: ğŸ Setup pnpm
        uses: pnpm/action-setup@v2
        with:
          run_install: false # Ğ½Ğµ ÑƒÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ½Ğ° ÑÑ‚Ğ¾Ğ¼ ÑÑ‚Ğ°Ğ¿Ğµ

      - name: ğŸ§¨ Get pnpm store directory # store path - Ğ¿ÑƒÑ‚ÑŒ Ğº Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ Ğ¿Ğ°ĞºĞµÑ‚Ğ¾Ğ², Ğ¿Ğ°ĞºĞµÑ‚Ñ‹ ĞºĞµÑˆĞ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ñ… actions
        id: pnpm-cache
        shell: bash
        run: |
          echo "STORE_PATH=$(pnpm store path)" >> $GITHUB_OUTPUT

      - name: ğŸ“¦ Setup pnpm cache # ĞºĞ»ÑÑ‡ Ğ´Ğ»Ñ ĞºĞµÑˆĞ°
        uses: actions/cache@v3
        with:
          path: ${{ steps.pnpm-cache.outputs.STORE_PATH }}
          key: ${{ runner.os }}-pnpm-store-${{ hashFiles('**/pnpm-lock.yaml') }}
          restore-keys: |
            ${{ runner.os }}-pnpm-store-

      - name: ğŸ” Install dependencies # Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑĞµĞ¹Ñ‡Ğ°Ñ ÑƒÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ÑÑ‚ÑÑ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
        run: pnpm install

      - name: âœ… Check code
        run: pnpm lint:js

  styles: # Ñ‚Ğ¾Ğ¶Ğµ Ñ‡Ñ‚Ğ¾ ÑĞ²ĞµÑ€Ñ…Ñƒ, Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ·Ğ°ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ
    name: ğŸ¨ Checking styles
    runs-on: ubuntu-latest

    steps:
      - name: â¬ Checkout
        uses: actions/checkout@v3

      - name: ğŸ§ Use Node.js v18.x
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: âš™ï¸ Enable corepack
        run: corepack enable

      - name: ğŸ“¦ Setup pnpm
        uses: pnpm/action-setup@v2
        with:
          run_install: false

      - name: ğŸ’¾ Get pnpm store directory
        id: pnpm-cache
        shell: bash
        run: |
          echo "STORE_PATH=$(pnpm store path)" >> $GITHUB_OUTPUT

      - name: ğŸ“¦ Setup pnpm cache
        uses: actions/cache@v3
        with:
          path: ${{ steps.pnpm-cache.outputs.STORE_PATH }}
          key: ${{ runner.os }}-pnpm-store-${{ hashFiles('**/pnpm-lock.yaml') }}
          restore-keys: |
            ${{ runner.os }}-pnpm-store-

      - name: ğŸ” Install dependencies
        run: pnpm install

      - name: âœ… Check styles # Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑÑ‚Ğ¾ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ°ĞµÑ‚ÑÑ
        run: pnpm lint:css
